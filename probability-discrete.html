
<!DOCTYPE html>


<html lang="en" data-content_root="./" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. Probability (Discrete) &#8212; Probabilistic Foundations of Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/css/course_schedule.css?v=244d4a68" />
    <link rel="stylesheet" type="text/css" href="_static/css/main.css?v=19873a65" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'probability-discrete';</script>
    <link rel="canonical" href="https://mogu-lab.github.io/probabilistic-foundations-of-ml/probability-discrete.html" />
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Conditional Probability (Discrete)" href="probability-conditional.html" />
    <link rel="prev" title="3. Advanced Vectorization" href="vectorization-advanced.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Probabilistic Foundations of Machine Learning - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Probabilistic Foundations of Machine Learning - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Probabilistic Foundations of ML
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Probabilistic ML: What is it? Why use it?</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectorization-basics.html">2. Introduction to Vectorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectorization-advanced.html">3. Advanced Vectorization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Directed Graphical Models</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. Probability (Discrete)</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability-conditional.html">5. Conditional Probability (Discrete)</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability-joint.html">6. Joint Probability (Discrete)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ethics-of-data.html">7. The Ethics of Data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Frequentist Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="mle-theory.html">8. Maximum Likelihood: Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="mle-code.html">9. Maximum Likelihood: Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html">10. Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability-continuous.html">11. Probability (Continuous)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ethics-of-learning-from-data.html">12. The Ethics of Learning from Data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Predictive Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="regression.html">13. Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification.html">14. Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="neural-networks.html">15. Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="model-selection.html">16. Model Selection &amp; Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ethics-of-predictive-models.html">17. The Ethics of Predictive Models in Sociotechnical Systems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Generative Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="gmms.html">18. Gaussian Mixture Models (Clustering)</a></li>
<li class="toctree-l1"><a class="reference internal" href="factor-analysis.html">19. Factor Analysis (Dimensionality Reduction)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ethics-of-generative-models.html">20. The Ethics of Generative Models in Sociotechnical Systems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bayesian Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="priors-and-posteriors.html">21. Priors and Posteriors</a></li>
<li class="toctree-l1"><a class="reference internal" href="posterior-predictives.html">22. Posterior Predictives</a></li>
<li class="toctree-l1"><a class="reference internal" href="ethics-of-uncertainty-and-interpretability.html">23. The Ethics of Uncertainty and Interpretability in Human-AI Systems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Synthesis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ethics-of-ml.html">24. The Ethics of Machine Learning: A View from History</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/probability-discrete.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Probability (Discrete)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology-and-notation">4.1. Terminology and Notation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matching-the-distribution-to-the-scenario">4.2. Matching the Distribution to the Scenario</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="probability-discrete">
<h1><span class="section-number">4. </span>Probability (Discrete)<a class="headerlink" href="#probability-discrete" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import some helper functions (please ignore this!)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">utils</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span> 
</pre></div>
</div>
</div>
</div>
<p><strong>Context:</strong> As your first assignment at IHH’s ML team, you’ve been tasked with better understanding their Emergency Room (ER). Since you’re new, you’d first like to better understand how the ER works at a high level. Specifically, you’d like to answer questions like:</p>
<ul class="simple">
<li><p>How many beings come to ER every day?</p></li>
<li><p>Overall, what conditions do the beings come to the ER for? (e.g. inflamed antenna, fever, etc.)</p></li>
<li><p>How many being remain hospitalized over night?</p></li>
</ul>
<p>As such, today you’re carry out a preliminary “exploratory data analysis” (EDA).</p>
<p><strong>Challenge:</strong> The answer to both of these questions cannot be given by a single number (e.g. the number of beings that come to the ER changes from day to day). So how can we give a deterministic answer to a question whose response is inherently variable or <em>stochastic</em>? Answer: <em>probability distributions</em>. Probability distributions are the basic building block that we will use to build complex ML systems.</p>
<p><strong>Outline:</strong></p>
<ol class="arabic simple">
<li><p>Introduce and practice the concepts, terminology, and notation behind discrete probability distributions (leaving continuous distributions to a later time).</p></li>
<li><p>Answer the above questions using this new toolset.</p></li>
</ol>
<section id="terminology-and-notation">
<h2><span class="section-number">4.1. </span>Terminology and Notation<a class="headerlink" href="#terminology-and-notation" title="Link to this heading">#</a></h2>
<p>As in the spirit of all Computer Science classes, if we want the help of a computer to solve a problem, we need a <em>language</em> to precisely specify what we want it to do. In the same way that programming languages allow us to communicate to the computer a procedure we’d like it to execute, here, we will introduce the language—terminology and notation—from probability. In the future, we will translate statements in this language directly into code that a computer can run.</p>
<p>The terminology that we introduce here is slightly different from ones that you may have seen in a probability class. The reason for this is that we’re honing in on the minimal subset of terminology we need to describe a probabilistic ML model.</p>
<p><strong>Random Variable (RV):</strong> A variable whose possible values are outcomes of a random phenomenon.</p>
<blockquote>
<div><p>Example: Let <span class="math notranslate nohighlight">\(N\)</span> be an RV describing the number of beings that come into the ER on a given day.</p>
</div></blockquote>
<p><strong>Sample:</strong> A sample is a particular observation of the random phenomenon.</p>
<blockquote>
<div><p>Example: On Monday, we observed <span class="math notranslate nohighlight">\(N = 30\)</span> (on Tuesday, this number will be different).</p>
</div></blockquote>
<p><strong>Sample Space or Support:</strong> The set of all possible values that an RV can take on. For discrete probability, this set must be “countable” (though this is not important for now).</p>
<blockquote>
<div><p>Example: The sample space for <span class="math notranslate nohighlight">\(N\)</span> is the set <span class="math notranslate nohighlight">\(S = [0, 1, 2, \dots, \infty)\)</span>, since we can have any integer from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(\infty\)</span> (theoretically speaking) of beings come to the ER.</p>
</div></blockquote>
<p><strong>Probability Mass Function (PMF):</strong> A function mapping the outcome of an RV to the probability, or frequency with which it occurs. We can write the PMF as a mapping from the sample space to a number on the unit interval: <span class="math notranslate nohighlight">\(p: S \rightarrow [0, 1]\)</span>.</p>
<blockquote>
<div><p>Example: Let <span class="math notranslate nohighlight">\(p_N(\cdot)\)</span> denote the PMF of <span class="math notranslate nohighlight">\(N\)</span>, where the dot represents an argument we have not specified. We denote the probability that <span class="math notranslate nohighlight">\(N\)</span> takes on a specific value <span class="math notranslate nohighlight">\(n\)</span> as follows: <span class="math notranslate nohighlight">\(p_N(n)\)</span>. If we were told that <span class="math notranslate nohighlight">\(p_N(5) = 0.1\)</span>, this means that the probability that exactly 5 beings came to the ER is 0.1 (or 10%).</p>
</div></blockquote>
<p>PMFs have one notable property: the probability of all outcomes in the sample space must sum to 1.</p>
<blockquote>
<div><p>Example: Continuing with the above example, we have that <span class="math notranslate nohighlight">\(\sum\limits_{n \in S} p_N(n) = 1\)</span>.</p>
</div></blockquote>
<p><strong>Parameter:</strong> A parameter is a variable that controls the shape of the PMF.</p>
<blockquote>
<div><p>Example: To illustrate this, suppose we chose to model the above phenomenon using a <a class="reference external" href="https://en.wikipedia.org/wiki/Poisson_distribution" rel="noreferrer" target="_blank">Poisson distribution</a>. That is, <span class="math notranslate nohighlight">\(p_N(\cdot) = \text{Poisson}(\lambda)\)</span>. To understand what we mean by <em>parameter</em>, it doesn’t matter what a Poisson distribution is, where it came from, and what it’s useful for. Instead, notice that a Poisson distribution relies on one variable, <span class="math notranslate nohighlight">\(\lambda\)</span> (its <em>parameter</em>), which controls the shape of the distribution. Specifically, <span class="math notranslate nohighlight">\(\lambda\)</span> determines the average of the distribution. <span class="math notranslate nohighlight">\(\lambda = 10\)</span> means that an average of 10 beings come into the ER on a given day. Ideally, the choice of <span class="math notranslate nohighlight">\(\lambda\)</span> will be informed by our domain knowledge and by data observed from the ER. Here’s an example of how <span class="math notranslate nohighlight">\(p_N(\cdot)\)</span> changes with <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</div></blockquote>
<figure class="align-center" id="fig-poisson-pmf">
<a class="reference internal image-reference" href="_images/pmf_of_poisson.png"><img alt="_images/pmf_of_poisson.png" src="_images/pmf_of_poisson.png" style="width: 600px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4.1 </span><span class="caption-text">PMF of a Poisson RV with different values of <span class="math notranslate nohighlight">\(\lambda\)</span>.</span><a class="headerlink" href="#fig-poisson-pmf" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Independent, Identically Distributed (i.i.d):</strong> We say a variable is i.i.d if different observations of the same phenomenon are (1) independent (i.e. that do not affect one another) and if (2), they follow the same PMF. For example, when we flip a fair coin:</p>
<ol class="arabic simple">
<li><p>Independence: Previous flips do not affect future flips—if the coin landed heads, it does not affect its probability of landing heads in the future.</p></li>
<li><p>Identically Distributed: Every time we flip the coin, the probability of it landing heads is the same.</p></li>
</ol>
<p>In contrast, suppose we’re monitoring a patient’s vitals (like heart rate) in the Intensive Care Unit of the IHH. The patient’s heart rate now is <em>not independent</em> of their heart rate a moment ago; their heart rate now is likely close to their heart rate a moment ago.</p>
<blockquote>
<div><p>Example: We the notation <span class="math notranslate nohighlight">\(N \sim p_N(\cdot)\)</span> signifies that, the number of beings coming to the ER is distributed according to distribution <span class="math notranslate nohighlight">\(p_N(\cdot)\)</span>, and that <span class="math notranslate nohighlight">\(N\)</span> is sampled i.i.d.</p>
</div></blockquote>
<p>Often in ML, we’ll be given a data set consisting of i.i.d observations. To differentiate between these different observations—or samples—from the same i.i.d phenomenon, we’ll use a subscript.</p>
<blockquote>
<div><p>Continuing with the previous example, in which <span class="math notranslate nohighlight">\(N \sim p_N(\cdot)\)</span> denotes the number of being coming to the ER, we will have <span class="math notranslate nohighlight">\(n_1\)</span> beings coming in on day 1, <span class="math notranslate nohighlight">\(n_2\)</span> coming in on day 2, and so on.</p>
</div></blockquote>
<p><strong>Summary of Notation:</strong></p>
<ul class="simple">
<li><p>Let <span class="math notranslate nohighlight">\(R\)</span> denote an RV.</p></li>
<li><p><span class="math notranslate nohighlight">\(p_R(r)\)</span> is the evaluation of the PMF at <span class="math notranslate nohighlight">\(r\)</span>: i.e. what’s the probability that <span class="math notranslate nohighlight">\(R\)</span> equals the specific value <span class="math notranslate nohighlight">\(r\)</span>?</p></li>
<li><p><span class="math notranslate nohighlight">\(p_R(\cdot)\)</span> is the PMF whole of <span class="math notranslate nohighlight">\(R\)</span>—that is, it represents the distribution before asking about the probability of <span class="math notranslate nohighlight">\(R = r\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(R \sim p_R(\cdot)\)</span> denotes that <span class="math notranslate nohighlight">\(R\)</span> is sampled i.i.d from <span class="math notranslate nohighlight">\(p_R(\cdot)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(r_1, r_2, \dots\)</span> referes to each of the observations (or samples) from phenomenon <span class="math notranslate nohighlight">\(R\)</span>.</p></li>
</ul>
<div class="admonition-exercise-gaining-comfort-with-commonly-used-discrete-distributions admonition">
<p class="admonition-title">Exercise: Gaining comfort with commonly-used discrete distributions</p>
<p><strong>Part 1:</strong> Browse the Wikipedia pages for the following distributions:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Bernoulli_distribution" rel="noreferrer" target="_blank">Bernoulli</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Categorical_distribution" rel="noreferrer" target="_blank">Categorical</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Binomial_distribution" rel="noreferrer" target="_blank">Binomial</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Geometric_distribution" rel="noreferrer" target="_blank">Geometric</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Poisson_distribution" rel="noreferrer" target="_blank">Poisson</a></p></li>
</ul>
<p>Then, for each distribution,</p>
<ol class="arabic simple">
<li><p>Describe a random phenomenon from everyday life that can be described using the distribution.</p></li>
<li><p>Define a random variable for the phenomenon you described. Write the support and PMF for this random variable using the above notation.</p></li>
<li><p>Describe a setting of the distribution’s parameters that makes sense for your specific phenomenon (and explain why it makes sense).</p></li>
</ol>
<p><em>Hint: On each Wikipedia page, there’s a panel on the right side that summarizes the properties of the distribution (e.g. its support, PMF, example plots, etc.).</em></p>
<p>We’ll get you started with the Bernoulli distribution (and you can do the rest):</p>
<ol class="arabic simple">
<li><p>The Bernoulli distribution models any random choice between two options. For example, it can model a coin flip.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(H\)</span> be the outcome of a random coin flip. Support: <span class="math notranslate nohighlight">\(H \in S = \{0, 1\}\)</span>, where 1 is heads and 0 is tails. PMF: <span class="math notranslate nohighlight">\(p_H(h) = \rho^h \cdot (1 - \rho)^{1 - h}\)</span>, where <span class="math notranslate nohighlight">\(h \in S\)</span> and <span class="math notranslate nohighlight">\(0 \leq \rho \leq 1\)</span>.</p></li>
<li><p>For a fair coin, <span class="math notranslate nohighlight">\(\rho = 0.5\)</span>, indicating that on average, half of all coin flips will result in heads and the other in tails.</p></li>
</ol>
<p><strong>Part 2:</strong> How do the following distributions relate to one another?</p>
<ol class="arabic simple">
<li><p>Bernoulli and Categorical</p></li>
<li><p>Bernoulli and Binomial</p></li>
<li><p>Bernoulli and Geometric</p></li>
</ol>
</div>
</section>
<section id="matching-the-distribution-to-the-scenario">
<h2><span class="section-number">4.2. </span>Matching the Distribution to the Scenario<a class="headerlink" href="#matching-the-distribution-to-the-scenario" title="Link to this heading">#</a></h2>
<p>We’ll now start working with data from IHH’s ER. We’ll use a Python library called <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to read in the data, which is stored as a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import a bunch of libraries we&#39;ll be using below</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pylab</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpyro</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpyro.distributions</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">D</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>

<span class="c1"># Load the data into a pandas dataframe</span>
<span class="n">csv_fname</span> <span class="o">=</span> <span class="s1">&#39;data/IHH-ER.csv&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_fname</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Patient ID&#39;</span><span class="p">)</span>

<span class="c1"># Print a random sample of patients, just to see what&#39;s in the data</span>
<span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Day-of-Week</th>
      <th>Condition</th>
      <th>Hospitalized</th>
      <th>Antibiotics</th>
    </tr>
    <tr>
      <th>Patient ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9394</th>
      <td>Friday</td>
      <td>Allergic Reaction</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>898</th>
      <td>Sunday</td>
      <td>Allergic Reaction</td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>2398</th>
      <td>Saturday</td>
      <td>Entangled Antennas</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>5906</th>
      <td>Saturday</td>
      <td>Allergic Reaction</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2343</th>
      <td>Monday</td>
      <td>High Fever</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
    <tr>
      <th>8225</th>
      <td>Thursday</td>
      <td>High Fever</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
    <tr>
      <th>5506</th>
      <td>Tuesday</td>
      <td>High Fever</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>6451</th>
      <td>Thursday</td>
      <td>Allergic Reaction</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2670</th>
      <td>Sunday</td>
      <td>Intoxication</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3497</th>
      <td>Tuesday</td>
      <td>Allergic Reaction</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1087</th>
      <td>Monday</td>
      <td>High Fever</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1819</th>
      <td>Tuesday</td>
      <td>High Fever</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2308</th>
      <td>Tuesday</td>
      <td>Allergic Reaction</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>6084</th>
      <td>Monday</td>
      <td>High Fever</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3724</th>
      <td>Tuesday</td>
      <td>Allergic Reaction</td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see, the data contains several variables:</p>
<ul class="simple">
<li><p><strong>Patient ID.</strong> A unique ID for identifying IHH ER patients. Don’t worry, the IDs have already been de-anonymized, meaning that they cannot be used to connect back to the patient’s medical records.</p></li>
<li><p><strong>Day-of-Week.</strong> The day of the week on which the patient came to the IHH ER.</p></li>
<li><p><strong>Condition.</strong> What the patient came to the ER for. As you can see, there are a variety of reasons intergalactic beings come to the IHH’s ER!</p></li>
<li><p><strong>Hospitalized.</strong> Whether the patient was hospitalized (yes or no).</p></li>
<li><p><strong>Antibiotics.</strong> Whether the patient was given antibiotics (yes or no).</p></li>
</ul>
<div class="admonition-exercise-visualizing-the-distribution-of-each-variable admonition">
<p class="admonition-title">Exercise: Visualizing the distribution of each variable</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to visualize the distribution of each variable. You may have to do some googling around to determine which library calls are appropriate for each variable.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">Patient</span> <span class="pre">ID</span></code> is not a variable.</p>
</div>
<p>We’ll start you off by visualizing the distribution of patients arriving on each day of the week:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the distribution of conditions at the IHH ER</span>

<span class="c1"># Compute the percentage of patients with each condition</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Day-of-Week&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Put the names of the variables in to x, and the percentage into y</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">variable</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span>

<span class="c1"># Plot!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Add axis labels and titles</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Day of Week&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Patients by Day at the IHH ER&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/45a1e64e3cffa91e48d14ed27e53539a0d3587749cffa89210776be51970e10a.png" src="_images/45a1e64e3cffa91e48d14ed27e53539a0d3587749cffa89210776be51970e10a.png" />
</div>
</div>
<div class="admonition-exercise-matching-the-distributions-to-the-data admonition">
<p class="admonition-title">Exercise: Matching the distributions to the data</p>
<ol class="arabic simple">
<li><p>Determine which distribution from the list above best matches each variable in the data. How did you decide which one to choose? Please justify your choice with the support and PMF of the distribution.</p></li>
<li><p>What kind of information do we miss out on when considering each variable separately? For this question, pick <strong>one example</strong> of a variable you recommend the IHH considers jointly with another variable. Explain why it’s important not to look at this variable alone, backing up your claim with a plot.</p></li>
</ol>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="vectorization-advanced.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Advanced Vectorization</p>
      </div>
    </a>
    <a class="right-next"
       href="probability-conditional.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Conditional Probability (Discrete)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology-and-notation">4.1. Terminology and Notation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matching-the-distribution-to-the-scenario">4.2. Matching the Distribution to the Scenario</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <footer>
  <div class="flex-shrink-0 container">
    <div class="row align-items-center">
      <div class="col-8">

        <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><span property="dct:title">Probabilistic Foundations of Machine Learning</span> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://yanivyacoby.github.io/" target="_blank">Yaniv Yacoby</a> is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" alt=""></a></p>

      </div>      
      <div class="col-4">
        <img src="_static/img/wc-logo-blue.png" alt="Wellesley College Logo" class="only-light" style="max-width: 120px; float: right; display: block;"/>
        <img src="_static/img/wc-logo-white.png" alt="Wellesley College Logo" class="only-dark" style="max-width: 120px; float: right; display: block;"/>
      </div>
    </div>    
  </div>  
</footer>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>